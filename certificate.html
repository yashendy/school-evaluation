<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>Ø´Ù‡Ø§Ø¯Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="data:,">

<style>
  /* A4 Landscape â€“ Ø¨Ø¯ÙˆÙ† Ù‡ÙˆØ§Ù…Ø´ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© */
  @page { size: A4 landscape; margin: 0; }
  html, body { height:100%; }
  body{
    margin:0;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    font-family: Tahoma, Arial, "Segoe UI", sans-serif;
    background:#f6f8fa;
  }

  /* Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙˆØ±Ù‚Ø©: 297 Ã— 210 Ù…Ù… */
  .sheet{
    position:relative;
    width: 297mm;
    height: 210mm;
    margin: 0 auto;
    overflow:hidden;
    background:#fff;
    box-shadow: 0 8px 24px rgba(0,0,0,.08);
  }

  /* Ø§Ù„Ø®Ù„ÙÙŠØ© ÙƒØµÙˆØ±Ø© Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ±Ù‡Ø§ ÙÙŠ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
  .bg{
    position:absolute; inset:0;
    width:100%; height:100%;
    object-fit:cover; /* ØºÙŠÙ‘Ø±ÙŠÙ‡Ø§ Ù„Ù€ contain Ù„Ùˆ Ù„Ø²Ù… */
    z-index:0;
  }

  .overlay{ position:relative; z-index:1; width:100%; height:100%; }

  /* ===== ØªÙ…ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù…Ø¹Ø§ÙŠØ±Ø©) ===== */
  /* Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù…Ù†Ù‚Ù‘Ø· */
  .pos-name{
    position:absolute;
    top: 45%;       /* â¬…ï¸ Ø¹Ø¯Ù‘Ù„ÙŠ Ø­Ø³Ø¨ Ø­Ø§Ø¬ØªÙƒ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù…ÙŠ ÙˆØ¶Ø¹ debug */
    right: 14%;     /* Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ø·Ø± Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† */
    width: 60%;     /* Ø·ÙˆÙ„ Ø§Ù„Ø³Ø·Ø± */
    text-align: right;
    font-size: 30px;
    font-weight: 700;
    color:#000;
    letter-spacing: .3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* ÙƒØªÙ„Ø© "Ø§Ù„ØªÙˆÙ‚ÙŠØ¹" */
  .pos-sign{
    position:absolute;
    top: 70%;       /* â¬…ï¸ Ù…Ù†Ø·Ù‚Ø© "Ø§Ù„ØªÙˆÙ‚ÙŠØ¹" ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ */
    left: 16%;
    text-align: right; /* Ø¹Ù„Ø´Ø§Ù† ØªØ·Ø§Ø¨Ù‚ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù…Ù†Ù‚Ù‘Ø· */
    font-size: 16px;
    color:#111;
    line-height: 1.6;
  }
  .pos-sign .muted{ font-size: 14px; color:#333; }

  /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© */
  .calib-panel{
    position:fixed; inset:auto 12px 12px 12px;
    background:rgba(0,0,0,.65); color:#fff; padding:10px 12px; border-radius:10px;
    font: 13px/1.6 Tahoma,Arial;
    display:none;
  }
  .calib-panel b{ color:#80ffea; }
  .outline-debug .pos-name{ outline: 2px dashed #1e88e5; outline-offset:2px; }
  .outline-debug .pos-sign{ outline: 2px dashed #43a047; outline-offset:2px; }

  .btns{ margin:16px auto; text-align:center }
  .btns button{ padding:10px 16px; border-radius:8px; border:1px solid #ccc; cursor:pointer; background:#f7f7f7 }

  @media print {
    body{ background:#fff; }
    .sheet{ box-shadow:none; margin:0; }
    .btns, .calib-panel{ display:none !important; }
  }
</style>
</head>
<body>

  <div class="sheet" id="sheet">
    <!-- Ù„Ùˆ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø¢Ø®Ø± Ø¹Ø¯Ù‘Ù„ÙŠ Ø§Ù„Ù…Ø³Ø§Ø± -->
    <img class="bg" src="certificate-bg.jpg" alt="Ø®Ù„ÙÙŠØ© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©" onerror="this.style.display='none'">

    <div class="overlay">
      <!-- Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù…Ù†Ù‚Ù‘Ø· -->
      <div class="pos-name" id="nm">â€”</div>

      <!-- Ø¹Ù†Ø¯ Ø®Ø§Ù†Ø© "Ø§Ù„ØªÙˆÙ‚ÙŠØ¹": Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø© + Ø§Ù„Ù…Ø§Ø¯Ø© + Ø§Ù„Ø´Ù‡Ø±/Ø§Ù„Ø³Ù†Ø© -->
      <div class="pos-sign" id="signBlock">
        <div id="teacherLabel">Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</div>
        <div class="muted" id="subjectLine">Ù…Ø§Ø¯Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</div>
        <div class="muted" id="when">Ø¹Ù† Ø´Ù‡Ø± â€” â€”</div>
      </div>
    </div>
  </div>

  <div class="btns">
    <button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
  </div>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© (ØªØ¸Ù‡Ø± ÙÙŠ ÙˆØ¶Ø¹ debug=1) -->
  <div class="calib-panel" id="calib">
    <div>ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© Ù…ÙØ¹Ù„ âœ… â€” Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ø£Ø³Ù‡Ù… Ù„ØªØ­Ø±ÙŠÙƒ <b>Ø§Ù„Ø§Ø³Ù…</b>ØŒ Ùˆ<strong>Shift+Ø§Ù„Ø£Ø³Ù‡Ù…</strong> Ù„ØªØ­Ø±ÙŠÙƒ <b>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</b>.</div>
    <div>Ctrl/âŒ˜ + Ø§Ù„Ø£Ø³Ù‡Ù… = ØªØºÙŠÙŠØ± <b>Ø§Ù„Ø¹Ø±Ø¶ Width</b> Ù„Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨.</div>
    <div>Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
      <div>name: top=<b id="v-nt"></b> â€¢ right=<b id="v-nr"></b> â€¢ width=<b id="v-nw"></b></div>
      <div>sign: top=<b id="v-st"></b> â€¢ left=<b id="v-sl"></b></div>
    </div>
    <div>Ø§Ù†Ù‚Ø±ÙŠ Ù„Ù†Ø³Ø® CSS: <button id="copyCss">Ù†Ø³Ø® Ø§Ù„Ù‚ÙŠÙ…</button></div>
  </div>

<script>
  (function(){
    const p = new URLSearchParams(location.search);

    // 1) ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const name  = p.get('name')  || 'Ø·Ø§Ù„Ø¨';
    const month = p.get('month') || '';
    const year  = p.get('year')  || new Date().getFullYear();
    const teacher = p.get('teacher') || '';      // Ø§Ø®ØªÙŠØ§Ø±ÙŠ
    const subject = p.get('subject') || 'Ù…Ø§Ø¯Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©'; // Ù„Ùˆ Ø¹Ø§ÙŠØ²Ø© ØªØºÙŠÙŠØ±Ù‡Ø§ Ù…Ù† Ø±Ø§Ø¨Ø·

    document.getElementById('nm').textContent = name;

    // Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
    document.getElementById('teacherLabel').textContent = teacher ? `Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø©: ${teacher}` : 'Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø©';
    document.getElementById('subjectLine').textContent  = subject;
    document.getElementById('when').textContent         = month ? `Ø¹Ù† Ø´Ù‡Ø± ${month} ${year}` : `Ø¹Ù† Ø´Ù‡Ø± â€” ${year}`;

    // 2) Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ù„ÙÙŠØ©
    const img = document.querySelector('.bg');
    const printNow = () => setTimeout(()=>window.print(), 400);
    if (!img || img.complete) maybePrint();
    else {
      img.addEventListener('load', maybePrint);
      img.addEventListener('error', maybePrint);
    }

    // Ù„Ùˆ ÙÙŠÙ‡ debug=1 Ù…Ø§ Ù†Ø·Ø¨Ø¹Ø´ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    function maybePrint(){
      const debug = p.get('debug') === '1';
      if (!debug) printNow();
      setupDebug(debug);
    }

    // 3) ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© (debug=1): Ø£Ø³Ù‡Ù… Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù†Ø§ØµØ± + Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙŠÙ…
    function setupDebug(enabled){
      const panel = document.getElementById('calib');
      const sheet = document.getElementById('sheet');
      if (!enabled){ panel.style.display='none'; return; }

      panel.style.display='block';
      sheet.classList.add('outline-debug');

      const nameEl = document.querySelector('.pos-name');
      const signEl = document.querySelector('.pos-sign');

      const v = {
        nt: document.getElementById('v-nt'),
        nr: document.getElementById('v-nr'),
        nw: document.getElementById('v-nw'),
        st: document.getElementById('v-st'),
        sl: document.getElementById('v-sl'),
      };

      function getPercent(val, axis){ // px -> %
        const base = axis === 'x' ? sheet.clientWidth : sheet.clientHeight;
        return (val/base)*100;
      }
      function setPercent(el, prop, val){ el.style[prop] = val.toFixed(2)+'%'; }

      // Ø§Ù‚Ø±Ø¦ÙŠ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙƒÙ†ÙØ³ÙØ¨ %
      function readPercents(){
        const rectS = sheet.getBoundingClientRect();
        const rectN = nameEl.getBoundingClientRect();
        const rectG = signEl.getBoundingClientRect();

        const topN   = getPercent(rectN.top   - rectS.top, 'y');
        const rightN = getPercent(rectS.right - rectN.right, 'x');
        const widthN = getPercent(rectN.width, 'x');

        const topG = getPercent(rectG.top  - rectS.top, 'y');
        const leftG= getPercent(rectG.left - rectS.left,'x');

        v.nt.textContent = topN.toFixed(2)+'%';
        v.nr.textContent = rightN.toFixed(2)+'%';
        v.nw.textContent = widthN.toFixed(2)+'%';
        v.st.textContent = topG.toFixed(2)+'%';
        v.sl.textContent = leftG.toFixed(2)+'%';
      }

      readPercents();

      // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø³Ù‡Ù…:
      // Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ù…ÙØ§ØªÙŠØ­: ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø§Ø³Ù…
      // Shift: ØªØ­Ø±ÙŠÙƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
      // Ctrl/âŒ˜ + Ø£Ø³Ù‡Ù… ÙŠÙ…ÙŠÙ†/ÙŠØ³Ø§Ø±: ØªØºÙŠÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³Ù…
      window.addEventListener('keydown', (e)=>{
        const step = e.altKey ? 0.2 : 0.6; // Alt Ù„Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©
        let handled = false;

        const useSign = e.shiftKey;
        if (!e.ctrlKey && !e.metaKey){
          // ØªØ­Ø±ÙŠÙƒ top/left/right
          if (!useSign){
            // Ø§Ù„Ø§Ø³Ù…: top + right
            const curTop = parseFloat(getComputedStyle(nameEl).top);
            const curRight = parseFloat(getComputedStyle(nameEl).right);
            if (e.key === 'ArrowUp'){ setPercent(nameEl,'top', curTop - step); handled = true; }
            if (e.key === 'ArrowDown'){ setPercent(nameEl,'top', curTop + step); handled = true; }
            if (e.key === 'ArrowRight'){ setPercent(nameEl,'right', curRight - step); handled = true; }
            if (e.key === 'ArrowLeft'){ setPercent(nameEl,'right', curRight + step); handled = true; }
          } else {
            // Ø§Ù„ØªÙˆÙ‚ÙŠØ¹: top + left
            const curTop = parseFloat(getComputedStyle(signEl).top);
            const curLeft = parseFloat(getComputedStyle(signEl).left);
            if (e.key === 'ArrowUp'){ setPercent(signEl,'top', curTop - step); handled = true; }
            if (e.key === 'ArrowDown'){ setPercent(signEl,'top', curTop + step); handled = true; }
            if (e.key === 'ArrowRight'){ setPercent(signEl,'left', curLeft + step); handled = true; }
            if (e.key === 'ArrowLeft'){ setPercent(signEl,'left', curLeft - step); handled = true; }
          }
        } else if ((e.ctrlKey || e.metaKey) && !useSign){
          // ØªØºÙŠÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³Ù…
          const curW = parseFloat(getComputedStyle(nameEl).width);
          if (e.key === 'ArrowRight'){ setPercent(nameEl,'width', curW + step); handled = true; }
          if (e.key === 'ArrowLeft'){ setPercent(nameEl,'width', curW - step); handled = true; }
        }

        if (handled){
          e.preventDefault();
          readPercents();
        }
      });

      // Ù†Ø³Ø® CSS Ø§Ù„Ø­Ø§Ù„ÙŠ
      document.getElementById('copyCss').onclick = () => {
        const css = `
.pos-name{ top:${v.nt.textContent}; right:${v.nr.textContent}; width:${v.nw.textContent}; }
.pos-sign{ top:${v.st.textContent}; left:${v.sl.textContent}; }
`.trim();
        navigator.clipboard.writeText(css).then(()=>{
          alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù‚ÙŠÙ…. Ø§Ù„ØµÙ‚ÙŠÙ‡Ø§ Ø¯Ø§Ø®Ù„ CSS Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙˆØ§Ø¶Ø¹.');
        });
      };
    }
  })();
</script>
</body>
</html>
