<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>ุดูุงุฏุฉ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="data:,">

<style>
  /* A4 Landscape โ ุจุฏูู ููุงูุด ููุทุจุงุนุฉ */
  @page { size: A4 landscape; margin: 0; }
  html, body { height:100%; }
  body{
    margin:0;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    font-family: Tahoma, Arial, "Segoe UI", sans-serif;
    background:#f6f8fa;
  }

  /* ูุณุงุญุฉ ุงููุฑูุฉ: 297 ร 210 ูู */
  .sheet{
    position:relative;
    width: 297mm;
    height: 210mm;
    margin: 0 auto;
    overflow:hidden;
    background:#fff;
    box-shadow: 0 8px 24px rgba(0,0,0,.08);
  }

  /* ุงูุฎูููุฉ ูุตูุฑุฉ ูุถูุงู ุธููุฑูุง ูู ุงูุทุจุงุนุฉ */
  .bg{
    position:absolute; inset:0;
    width:100%; height:100%;
    object-fit:cover; /* ุบููุฑููุง ูู contain ูู ูุฒู */
    z-index:0;
  }

  .overlay{ position:relative; z-index:1; width:100%; height:100%; }

  /* ===== ุชููุถุน ุงูุนูุงุตุฑ (ูุงุจูุฉ ูููุนุงูุฑุฉ) ===== */
  /* ุงุณู ุงูุทุงูุจ ุนูู ุงูุณุทุฑ ุงูููููุท */
  .pos-name {
    position: absolute;
    top: 44.98%;     /* ุงููุณุงูุฉ ูู ุฃุนูู ุงููุฑูุฉ */
    right: 25%;   /* ุจุฏุงูุฉ ุงููุฑุจุน ูู ูุงุญูุฉ ุงููููู */
    width: 75%;      /* ุนุฑุถ ุงููุฑุจุน - ุตุบุฑุชู ุนู 59.97% ุนูุดุงู ูุง ููุจุฑุด */
    text-align: center; /* ูุณุท ุงูููุงู ุฌูู ุงููุฑุจุน */
    font-size: 30px;  /* ุญุฌู ุงูุฎุท */
    font-weight: 700; /* ุณูู ุงูุฎุท */
    color: #000;      /* ููู ุงููุต */
    letter-spacing: .5px; /* ูุณุงูุฉ ุจุณูุทุฉ ุจูู ุงูุญุฑูู */
    white-space: nowrap; /* ูููุน ุงูุงุณู ูู ุงููุฒูู ูุณุทุฑ ุฌุฏูุฏ */
    overflow: hidden; /* ูููุน ุฎุฑูุฌ ุงููุต ุจุฑุง ุงููุฑุจุน */
    text-overflow: ellipsis; /* ูุญุท ... ูู ุงูุงุณู ุทููู */
}


  /* ูุชูุฉ "ุงูุชูููุน" */
  .pos-sign{
    position:absolute;
    top: 70%;       /* โฌ๏ธ ููุทูุฉ "ุงูุชูููุน" ุชูุฑูุจูุง */
    left: 10%;
    text-align: right; /* ุนูุดุงู ุชุทุงุจู ุงุชุฌุงู ุงูุณุทุฑ ุงูููููุท */
    font-size: 16px;
    color:#111;
    line-height: 1.6;
  }
  .pos-sign .muted{ font-size: 14px; color:#333; }

  /* ุดุฑูุท ุงููุนุงูุฑุฉ */
  .calib-panel{
    position:fixed; inset:auto 12px 12px 12px;
    background:rgba(0,0,0,.65); color:#fff; padding:10px 12px; border-radius:10px;
    font: 13px/1.6 Tahoma,Arial;
    display:none;
  }
  .calib-panel b{ color:#80ffea; }
  .outline-debug .pos-name{ outline: 2px dashed #1e88e5; outline-offset:2px; }
  .outline-debug .pos-sign{ outline: 2px dashed #43a047; outline-offset:2px; }

  .btns{ margin:16px auto; text-align:center }
  .btns button{ padding:10px 16px; border-radius:8px; border:1px solid #ccc; cursor:pointer; background:#f7f7f7 }

  @media print {
    body{ background:#fff; }
    .sheet{ box-shadow:none; margin:0; }
    .btns, .calib-panel{ display:none !important; }
  }
</style>
</head>
<body>

  <div class="sheet" id="sheet">
    <!-- ูู ุงูุตูุฑุฉ ูู ูุฌูุฏ ุขุฎุฑ ุนุฏููู ุงููุณุงุฑ -->
    <img class="bg" src="certificate-bg.jpg" alt="ุฎูููุฉ ุงูุดูุงุฏุฉ" onerror="this.style.display='none'">

    <div class="overlay">
      <!-- ุงุณู ุงูุทุงูุจ ุนูู ุงูุณุทุฑ ุงูููููุท -->
      <div class="pos-name" id="nm">โ</div>

      <!-- ุนูุฏ ุฎุงูุฉ "ุงูุชูููุน": ูุนูู ุงููุงุฏุฉ + ุงููุงุฏุฉ + ุงูุดูุฑ/ุงูุณูุฉ -->
      <div class="pos-sign" id="signBlock">
        <div id="teacherLabel">ูุนูู ุงููุงุฏุฉ</div>
        <div class="muted" id="subjectLine">ูุงุฏุฉ ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</div>
        <div class="muted" id="when">ุนู ุดูุฑ โ โ</div>
      </div>
    </div>
  </div>

  <div class="btns">
    <button onclick="window.print()">๐จ๏ธ ุทุจุงุนุฉ</button>
  </div>

  <!-- ููุญุฉ ุงููุนุงูุฑุฉ (ุชุธูุฑ ูู ูุถุน debug=1) -->
  <div class="calib-panel" id="calib">
    <div>ูุถุน ุงููุนุงูุฑุฉ ููุนู โ โ ุงุณุชุฎุฏูู ุงูุฃุณูู ูุชุญุฑูู <b>ุงูุงุณู</b>ุ ู<strong>Shift+ุงูุฃุณูู</strong> ูุชุญุฑูู <b>ุงูุชูููุน</b>.</div>
    <div>Ctrl/โ + ุงูุฃุณูู = ุชุบููุฑ <b>ุงูุนุฑุถ Width</b> ูุงุณู ุงูุทุงูุจ.</div>
    <div>ุงูููู ุงูุญุงููุฉ:
      <div>name: top=<b id="v-nt"></b> โข right=<b id="v-nr"></b> โข width=<b id="v-nw"></b></div>
      <div>sign: top=<b id="v-st"></b> โข left=<b id="v-sl"></b></div>
    </div>
    <div>ุงููุฑู ููุณุฎ CSS: <button id="copyCss">ูุณุฎ ุงูููู</button></div>
  </div>

<script>
  (function(){
    const p = new URLSearchParams(location.search);

    // 1) ุชุนุจุฆุฉ ุงูุจูุงูุงุช
    const name  = p.get('name')  || 'ุทุงูุจ';
    const month = p.get('month') || '';
    const year  = p.get('year')  || new Date().getFullYear();
    const teacher = p.get('teacher') || '';      // ุงุฎุชูุงุฑู
    const subject = p.get('subject') || 'ูุงุฏุฉ ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ'; // ูู ุนุงูุฒุฉ ุชุบููุฑูุง ูู ุฑุงุจุท

    document.getElementById('nm').textContent = name;

    // ุงูุชูููุน
    document.getElementById('teacherLabel').textContent = teacher ? `ูุนูู ุงููุงุฏุฉ: ${teacher}` : 'ูุนูู ุงููุงุฏุฉ';
    document.getElementById('subjectLine').textContent  = subject;
    document.getElementById('when').textContent         = month ? `ุนู ุดูุฑ ${month} ${year}` : `ุนู ุดูุฑ โ ${year}`;

    // 2) ุทุจุงุนุฉ ุจุนุฏ ุชุญููู ุงูุฎูููุฉ
    const img = document.querySelector('.bg');
    const printNow = () => setTimeout(()=>window.print(), 400);
    if (!img || img.complete) maybePrint();
    else {
      img.addEventListener('load', maybePrint);
      img.addEventListener('error', maybePrint);
    }

    // ูู ููู debug=1 ูุง ูุทุจุนุด ุชููุงุฆููุง
    function maybePrint(){
      const debug = p.get('debug') === '1';
      if (!debug) printNow();
      setupDebug(debug);
    }

    // 3) ูุถุน ุงููุนุงูุฑุฉ (debug=1): ุฃุณูู ูุชุญุฑูู ุงูุนูุงุตุฑ + ุนุฑุถ ุงูููู
    function setupDebug(enabled){
      const panel = document.getElementById('calib');
      const sheet = document.getElementById('sheet');
      if (!enabled){ panel.style.display='none'; return; }

      panel.style.display='block';
      sheet.classList.add('outline-debug');

      const nameEl = document.querySelector('.pos-name');
      const signEl = document.querySelector('.pos-sign');

      const v = {
        nt: document.getElementById('v-nt'),
        nr: document.getElementById('v-nr'),
        nw: document.getElementById('v-nw'),
        st: document.getElementById('v-st'),
        sl: document.getElementById('v-sl'),
      };

      function getPercent(val, axis){ // px -> %
        const base = axis === 'x' ? sheet.clientWidth : sheet.clientHeight;
        return (val/base)*100;
      }
      function setPercent(el, prop, val){ el.style[prop] = val.toFixed(2)+'%'; }

      // ุงูุฑุฆู ุงูููู ุงูุญุงููุฉ ูููุณูุจ %
      function readPercents(){
        const rectS = sheet.getBoundingClientRect();
        const rectN = nameEl.getBoundingClientRect();
        const rectG = signEl.getBoundingClientRect();

        const topN   = getPercent(rectN.top   - rectS.top, 'y');
        const rightN = getPercent(rectS.right - rectN.right, 'x');
        const widthN = getPercent(rectN.width, 'x');

        const topG = getPercent(rectG.top  - rectS.top, 'y');
        const leftG= getPercent(rectG.left - rectS.left,'x');

        v.nt.textContent = topN.toFixed(2)+'%';
        v.nr.textContent = rightN.toFixed(2)+'%';
        v.nw.textContent = widthN.toFixed(2)+'%';
        v.st.textContent = topG.toFixed(2)+'%';
        v.sl.textContent = leftG.toFixed(2)+'%';
      }

      readPercents();

      // ุงูุชุญูู ุจุงูุฃุณูู:
      // ุจุฏูู ุฃู ููุงุชูุญ: ุชุญุฑูู ุงูุงุณู
      // Shift: ุชุญุฑูู ุงูุชูููุน
      // Ctrl/โ + ุฃุณูู ูููู/ูุณุงุฑ: ุชุบููุฑ ุนุฑุถ ุงูุงุณู
      window.addEventListener('keydown', (e)=>{
        const step = e.altKey ? 0.2 : 0.6; // Alt ููุญุฑูุฉ ุงูุฏูููุฉ
        let handled = false;

        const useSign = e.shiftKey;
        if (!e.ctrlKey && !e.metaKey){
          // ุชุญุฑูู top/left/right
          if (!useSign){
            // ุงูุงุณู: top + right
            const curTop = parseFloat(getComputedStyle(nameEl).top);
            const curRight = parseFloat(getComputedStyle(nameEl).right);
            if (e.key === 'ArrowUp'){ setPercent(nameEl,'top', curTop - step); handled = true; }
            if (e.key === 'ArrowDown'){ setPercent(nameEl,'top', curTop + step); handled = true; }
            if (e.key === 'ArrowRight'){ setPercent(nameEl,'right', curRight - step); handled = true; }
            if (e.key === 'ArrowLeft'){ setPercent(nameEl,'right', curRight + step); handled = true; }
          } else {
            // ุงูุชูููุน: top + left
            const curTop = parseFloat(getComputedStyle(signEl).top);
            const curLeft = parseFloat(getComputedStyle(signEl).left);
            if (e.key === 'ArrowUp'){ setPercent(signEl,'top', curTop - step); handled = true; }
            if (e.key === 'ArrowDown'){ setPercent(signEl,'top', curTop + step); handled = true; }
            if (e.key === 'ArrowRight'){ setPercent(signEl,'left', curLeft + step); handled = true; }
            if (e.key === 'ArrowLeft'){ setPercent(signEl,'left', curLeft - step); handled = true; }
          }
        } else if ((e.ctrlKey || e.metaKey) && !useSign){
          // ุชุบููุฑ ุนุฑุถ ุงูุงุณู
          const curW = parseFloat(getComputedStyle(nameEl).width);
          if (e.key === 'ArrowRight'){ setPercent(nameEl,'width', curW + step); handled = true; }
          if (e.key === 'ArrowLeft'){ setPercent(nameEl,'width', curW - step); handled = true; }
        }

        if (handled){
          e.preventDefault();
          readPercents();
        }
      });

      // ูุณุฎ CSS ุงูุญุงูู
      document.getElementById('copyCss').onclick = () => {
        const css = `
.pos-name{ top:${v.nt.textContent}; right:${v.nr.textContent}; width:${v.nw.textContent}; }
.pos-sign{ top:${v.st.textContent}; left:${v.sl.textContent}; }
`.trim();
        navigator.clipboard.writeText(css).then(()=>{
          alert('ุชู ูุณุฎ ุงูููู. ุงูุตูููุง ุฏุงุฎู CSS ูุชุซุจูุช ุงูููุงุถุน.');
        });
      };
    }
  })();
</script>
</body>
</html>








