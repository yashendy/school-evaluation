<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ููุญุฉ ุชุญูู ุงููุนูู</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.1/jspdf.umd.min.js"></script>
  <script src="firebase-config.js"></script>
  <style>
    /* ููุง ุงูุชูุณูู CSS ููุง ุณุจู */
  </style>
</head>
<body>
  <div class="main-container">
    <aside class="sidebar">
      <img src="logo.png" alt="Logo" />
      <h3 id="teacher-name">ุชุญููู...</h3>
      <button data-sec="classes">๐ ุงููุตูู</button>
      <button data-sec="students">๐จโ๐ ุงูุทูุงุจ</button>
      <button data-sec="tests">๐งช ุฅุฏุฎุงู ุงูุงุฎุชุจุงุฑุงุช</button>
      <button onclick="window.location.href='evaluations.html'">๐ ุนุฑุถ ุงูุชููููุงุช</button>
      <button onclick="auth.signOut().then(()=>location.href='index.html')">๐ช ุชุณุฌูู ุงูุฎุฑูุฌ</button>
    </aside>
    <main class="content"><div id="main-content"></div></main>
  </div>

  <script>
    // โ ุงููุฑุญูุฉ 1: ุชุณุฌูู ุงูุฏุฎูู
    const auth = firebase.auth();
    const db = firebase.firestore();
    let currentTeacherId = null;

    auth.onAuthStateChanged(async user => {
      if (!user) return location.href = 'index.html';
      currentTeacherId = user.uid;
      const doc = await db.collection('users').doc(currentTeacherId).get();
      const data = doc.data();
      if (!data || data.type !== 'teacher') {
        alert('โ ููุณ ูุฏูู ุตูุงุญูุฉ ุงูุฏุฎูู ุฅูู ูุฐู ุงูุตูุญุฉ');
        return auth.signOut().then(() => location.href = 'index.html');
      }
      document.getElementById('teacher-name').textContent = `ุฃ. ${data.name}`;
      document.querySelectorAll('.sidebar button[data-sec]').forEach(btn => {
        btn.addEventListener('click', () => showSection(btn.dataset.sec));
      });
      showSection('classes');
    });

    // โ ุงููุฑุญูุฉ 2: ุฏุงูุฉ ุงูุชููู ุจูู ุงูุฃูุณุงู
    function showSection(sec) {
      const main = document.getElementById('main-content');
      main.innerHTML = '';

      if (sec === 'classes') {
        main.innerHTML = `
          <div id="classes-section"><h2>๐ ุฅุฏุงุฑุฉ ุงููุตูู</h2>
            <div>
              <select id="c-grade">
                <option>ุงูุตู ุงูุฃูู</option><option>ุงูุตู ุงูุซุงูู</option><option>ุงูุตู ุงูุซุงูุซ</option>
                <option>ุงูุตู ุงูุฑุงุจุน</option><option>ุงูุตู ุงูุฎุงูุณ</option><option>ุงูุตู ุงูุณุงุฏุณ</option>
              </select>
              <select id="c-system"><option>ุนุฑุจู</option><option>ูุบุงุช</option></select>
              <select id="c-section"><option>A</option><option>B</option><option>C</option><option>D</option></select>
              <button class="save-btn" onclick="addClass()">ุฅุถุงูุฉ ูุตู</button>
            </div>
            <h3>๐ ูุตูู ุงููุนูู</h3>
            <table id="classes-table"><thead><tr>
              <th>ุงูุตู</th><th>ุงููุธุงู</th><th>ุงููุณู</th><th>ุฅุฌุฑุงุก</th>
            </tr></thead><tbody></tbody></table>
          </div>`;
           
        loadTeacherClasses();
      if (sec === 'students') {
        main.innerHTML = `
          <div id="students-section"><h2>๐จโ๐ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h2>
            <div>
              <select id="s-grade">
                <option>ุงูุตู ุงูุฃูู</option><option>ุงูุตู ุงูุซุงูู</option><option>ุงูุตู ุงูุซุงูุซ</option>
                <option>ุงูุตู ุงูุฑุงุจุน</option><option>ุงูุตู ุงูุฎุงูุณ</option><option>ุงูุตู ุงูุณุงุฏุณ</option>
              </select>
              <select id="s-system"><option>ุนุฑุจู</option><option>ูุบุงุช</option></select>
              <select id="s-section"><option>A</option><option>B</option><option>C</option><option>D</option></select>
              <input type="text" id="s-name" placeholder="ุงุณู ุงูุทุงูุจ" />
              <select id="s-gender"><option value="male">ุฐูุฑ</option><option value="female">ุฃูุซู</option></select>
              <select id="s-religion"><option value="muslim">ูุณูู</option><option value="christian">ูุณูุญู</option></select>
              <button class="save-btn" onclick="addStudent()">ุฅุถุงูุฉ ุงูุทุงูุจ</button>
              <button class="save-btn" onclick="loadStudentList()">ุนุฑุถ ุทูุงุจ ุงููุตู</button>
              <input type="search" id="student-search" placeholder="ุงุจุญุซ ุจุงุณู ุงูุทุงูุจ..." list="students-list" />
              <datalist id="students-list"></datalist>
            </div>
            <h3>๐ ุทูุงุจ ุงููุตู</h3>
            <table id="students-table"><thead><tr>
              <th>ุงูุงุณู</th><th>ุงูููุน</th><th>ุงูุฏูุงูุฉ</th><th>ุฑูู ุงูุฌููุณ</th>
            </tr></thead><tbody></tbody></table>
          </div>`;
        loadClassDropdowns();
      }

      else if (sec === 'tests') {
        main.innerHTML = `
          <div id="tests-section"><h2>๐งช ุฅุฏุฎุงู ุงูุงุฎุชุจุงุฑุงุช</h2>
            <div>
              <label>ุงูุณูุฉ:</label><span id="year">${new Date().getFullYear()}</span>
              <label>ุงูุดูุฑ:</label>
              <select id="eval-month">
                ${["ููุงูุฑ","ูุจุฑุงูุฑ","ูุงุฑุณ","ุฃุจุฑูู","ูุงูู","ููููู","ููููู","ุฃุบุณุทุณ","ุณุจุชูุจุฑ","ุฃูุชูุจุฑ","ููููุจุฑ","ุฏูุณูุจุฑ"]
                  .map(m => `<option>${m}</option>`).join('')}
              </select>
              <label>ุงููุตู:</label><select id="eval-class" onchange="loadEvalStudents()"></select>
              <label>ุงูุทุงูุจ:</label><select id="eval-student" onchange="updateStudentName()"></select>
              <p>ุงุณู ุงูุทุงูุจ: <span id="stu-name"></span></p>
              <label>ุงุฎุชุจุงุฑ (10):</label><input type="number" id="input-test" min="0" max="10"/>
              <label>ูุงุฌุจ (10):</label><input type="number" id="input-home" min="0" max="10"/>
              <label>ูุดุงุฑูุฉ (10):</label><input type="number" id="input-part" min="0" max="10"/>
              <label>ุณููู (10):</label><input type="number" id="input-beh" value="10" min="0" max="10"/>
              <button class="save-btn" onclick="submitEvaluation()">ุญูุธ ุงูุชูููู</button>
            </div>

            <table id="eval-summary-table" style="width:100%; margin-top:20px; display:none;">
              <thead>
                <tr><th>ุงูุงุณู</th><th>ุงุฎุชุจุงุฑ</th><th>ูุงุฌุจ</th><th>ูุดุงุฑูุฉ</th><th>ุณููู</th><th>ุงููุฌููุน</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>`;
        loadEvalClasses();
      }
    }

    // โ ุจุงูู ุงููุฑุงุญู: ุฒู ูุง ูุงูุชุ ูุง ุชุชุนุฏูุด
    // addClass, loadTeacherClasses, deleteClass, addStudent, loadEvalClasses, displayStudents, etc.
    // ูุฏู ููู ูุง ููููุด ุฃู ูุดุงูู ูู ุงููุงุญูุฉ ุงูููุทููุฉ ุฃู ุงูุจูุงุฆูุฉ ๐
// ุงููุฑุญูุฉ 3: ุฅุฏุงุฑุฉ ุงููุตูู

// โ ุนุฑุถ ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงููุตูู
  if (sec === 'classes') {
    main.innerHTML = `
      <div id="classes-section"><h2>๐ ุฅุฏุงุฑุฉ ุงููุตูู</h2>
        <div>
          <select id="c-grade">
            <option>ุงูุตู ุงูุฃูู</option><option>ุงูุตู ุงูุซุงูู</option><option>ุงูุตู ุงูุซุงูุซ</option>
            <option>ุงูุตู ุงูุฑุงุจุน</option><option>ุงูุตู ุงูุฎุงูุณ</option><option>ุงูุตู ุงูุณุงุฏุณ</option>
          </select>
          <select id="c-system"><option>ุนุฑุจู</option><option>ูุบุงุช</option></select>
          <select id="c-section"><option>A</option><option>B</option><option>C</option><option>D</option></select>
          <button class="save-btn" onclick="addClass()">ุฅุถุงูุฉ ูุตู</button>
        </div>
        <h3>๐ ูุตูู ุงููุนูู</h3>
        <table id="classes-table"><thead><tr>
          <th>ุงูุตู</th><th>ุงููุธุงู</th><th>ุงููุณู</th><th>ุฅุฌุฑุงุก</th>
        </tr></thead><tbody></tbody></table>
      </div>`;
    loadTeacherClasses();
  }
}

// โ ุฅุถุงูุฉ ูุตู ุฌุฏูุฏ
async function addClass() {
  const grade = document.getElementById('c-grade').value;
  const system = document.getElementById('c-system').value;
  const section = document.getElementById('c-section').value;

  const existing = await db.collection('classes')
    .where('teacher', '==', currentTeacherId)
    .where('grade', '==', grade)
    .where('system', '==', system)
    .where('section', '==', section)
    .get();

  if (!existing.empty) {
    alert('โ๏ธ ูุฐุง ุงููุตู ูุถุงู ูุณุจูุงู');
    return;
  }

  await db.collection('classes').add({
    grade,
    system,
    section,
    teacher: currentTeacherId
  });

  alert('โ๏ธ ุชู ุฅุถุงูุฉ ุงููุตู');
  loadTeacherClasses();
}

// โ ุชุญููู ูุตูู ุงููุนูู ูุนุฑุถูุง ูู ุงูุฌุฏูู
async function loadTeacherClasses() {
  const tbody = document.querySelector('#classes-table tbody');
  if (!tbody) return;
  tbody.innerHTML = '';

  const snap = await db.collection('classes')
    .where('teacher', '==', currentTeacherId)
    .get();

  snap.forEach(doc => {
    const d = doc.data();
    tbody.innerHTML += `
      <tr>
        <td>${d.grade}</td>
        <td>${d.system}</td>
        <td>${d.section}</td>
        <td><button class="delete-btn" onclick="deleteClass('${doc.id}')">๐๏ธ ุญุฐู</button></td>
      </tr>`;
  });
}

// โ ุญุฐู ูุตู
async function deleteClass(classId) {
  await db.collection('classes').doc(classId).delete();
  alert('๐๏ธ ุชู ุญุฐู ุงููุตู');
  loadTeacherClasses();
}
// ุงููุฑุญูุฉ 4: ุฅุฏุงุฑุฉ ุงูุทูุงุจ

// โ ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงูุทูุงุจ
if (sec === 'students') {
  main.innerHTML = `
    <div id="students-section"><h2>๐จโ๐ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h2>
    <div>
      <select id="s-grade">
        <option>ุงูุตู ุงูุฃูู</option><option>ุงูุตู ุงูุซุงูู</option><option>ุงูุตู ุงูุซุงูุซ</option>
        <option>ุงูุตู ุงูุฑุงุจุน</option><option>ุงูุตู ุงูุฎุงูุณ</option><option>ุงูุตู ุงูุณุงุฏุณ</option>
      </select>
      <select id="s-system"><option>ุนุฑุจู</option><option>ูุบุงุช</option></select>
      <select id="s-section"><option>A</option><option>B</option><option>C</option><option>D</option></select>
      <input type="text" id="s-name" placeholder="ุงุณู ุงูุทุงูุจ" />
      <select id="s-gender"><option value="male">ุฐูุฑ</option><option value="female">ุฃูุซู</option></select>
      <select id="s-religion"><option value="muslim">ูุณูู</option><option value="christian">ูุณูุญู</option></select>
      <button class="save-btn" onclick="addStudent()">ุฅุถุงูุฉ ุงูุทุงูุจ</button>
      <button class="save-btn" onclick="loadStudentList()">ุนุฑุถ ุทูุงุจ ุงููุตู</button>
      <input type="search" id="student-search" placeholder="ุงุจุญุซ ุจุงุณู ุงูุทุงูุจ..." list="students-list" />
      <datalist id="students-list"></datalist>
    </div>
    <h3>๐ ุทูุงุจ ุงููุตู</h3>
    <table id="students-table"><thead><tr>
      <th>ุงูุงุณู</th><th>ุงูููุน</th><th>ุงูุฏูุงูุฉ</th><th>ุฑูู ุงูุฌููุณ</th>
    </tr></thead><tbody></tbody></table></div>`;
  loadClassDropdowns();
}

// โ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ
async function addStudent() {
  const g = document.getElementById('s-grade').value;
  const s = document.getElementById('s-system').value;
  const c = document.getElementById('s-section').value;
  const name = document.getElementById('s-name').value.trim();
  const gender = document.getElementById('s-gender').value;
  const religion = document.getElementById('s-religion').value;

  if (!name || !g || !s || !c || !gender || !religion) {
    return alert('โ ูุฌุจ ููุก ุฌููุน ุงูุญููู ุงูุฎุงุตุฉ ุจุงูุทุงูุจ');
  }

  // ุงูุชุญูู ูู ุงูุชูุฑุงุฑ ุฏุงุฎู ุฌููุน ุงูุตููู
  const duplicate = await db.collection('students')
    .where('teacher', '==', currentTeacherId)
    .where('name', '==', name)
    .get();

  if (!duplicate.empty) {
    return alert('โ๏ธ ุงูุงุณู ููุฌูุฏ ุจุงููุนู ูุฑุฌู ุงูุชุฃูุฏ ูู ุงุณู ุงูุทุงูุจ');
  }

  const classSnap = await db.collection('classes')
    .where('grade', '==', g)
    .where('system', '==', s)
    .where('section', '==', c)
    .where('teacher', '==', currentTeacherId)
    .get();

  if (classSnap.empty) {
    return alert('โ๏ธ ุนููุง... ุฃูุช ูู ุชุฏุฑุณ ููุฐุง ุงููุตู');
  }

  const classId = classSnap.docs[0].id;
  const seat = await generateSeat(gender, religion, classId);

  await db.collection('students').add({
    name, gender, religion,
    seatNumber: seat,
    classId,
    teacher: currentTeacherId
  });

  alert(`โ๏ธ ุชู ุฅุถุงูุฉ ุงูุทุงูุจ ${name} ุฑูู ุงูุฌููุณ: ${seat}`);
  displayStudents(classId);
}

// โ ุชูููุฏ ุฑูู ุงูุฌููุณ
async function generateSeat(gender, religion, classId) {
  const snap = await db.collection('students').where('classId','==',classId).get();
  const count = snap.size + 1;
  const codeG = gender === 'male' ? '1' : '2';
  const codeR = religion === 'muslim' ? '1' : '2';
  return codeG + codeR + String(count).padStart(4, '0');
}

// โ ุชุญููู ุงูููุงุฆู ุงูููุณุฏูุฉ ุงูุซุงุจุชุฉ
async function loadClassDropdowns() {
  const grades = document.getElementById('s-grade');
  grades.innerHTML = `
    <option>ุงูุตู ุงูุฃูู</option>
    <option>ุงูุตู ุงูุซุงูู</option>
    <option>ุงูุตู ุงูุซุงูุซ</option>
    <option>ุงูุตู ุงูุฑุงุจุน</option>
    <option>ุงูุตู ุงูุฎุงูุณ</option>
    <option>ุงูุตู ุงูุณุงุฏุณ</option>`;

  const systems = document.getElementById('s-system');
  systems.innerHTML = `<option>ุนุฑุจู</option><option>ูุบุงุช</option>`;

  const sections = document.getElementById('s-section');
  sections.innerHTML = `<option>A</option><option>B</option><option>C</option><option>D</option>`;

  const snap = await db.collection('classes').where('teacher','==',currentTeacherId).limit(1).get();
  if (!snap.empty) {
    const classId = snap.docs[0].id;
    displayStudents(classId);
  }
}

// โ ุนุฑุถ ุทูุงุจ ุงููุตู ุงููุญุฏุฏ
async function displayStudents(classId) {
  const tbody = document.querySelector('#students-table tbody');
  if (!tbody) return;
  tbody.innerHTML = '';

  const snap = await db.collection('students')
    .where('classId', '==', classId)
    .orderBy('seatNumber')
    .get();

  snap.forEach(doc => {
    const d = doc.data();
    tbody.innerHTML += `
      <tr>
        <td>${d.name}</td>
        <td>${d.gender === 'male' ? 'ุฐูุฑ' : 'ุฃูุซู'}</td>
        <td>${d.religion === 'muslim' ? 'ูุณูู' : 'ูุณูุญู'}</td>
        <td>${d.seatNumber}</td>
      </tr>`;
  });
}

// โ ุฒุฑ "ุนุฑุถ ุทูุงุจ ุงููุตู"
async function loadStudentList() {
  const g = document.getElementById('s-grade').value;
  const s = document.getElementById('s-system').value;
  const c = document.getElementById('s-section').value;

  const snap = await db.collection('classes')
    .where('grade', '==', g)
    .where('system', '==', s)
    .where('section', '==', c)
    .where('teacher', '==', currentTeacherId)
    .get();

  if (snap.empty) {
    alert('โ๏ธ ุงููุตู ุบูุฑ ููุฌูุฏ');
    return;
  }

  const classId = snap.docs[0].id;
  displayStudents(classId);

  // ุชุนุจุฆุฉ datalist ููุจุญุซ
  const list = document.getElementById('students-list');
  list.innerHTML = '';
  const studentsSnap = await db.collection('students').where('classId', '==', classId).get();

  studentsSnap.forEach(doc => {
    const d = doc.data();
    const opt = document.createElement('option');
    opt.value = d.name;
    list.appendChild(opt);
  });
}
// ๐ ุงููุฑุญูุฉ 5: ุฅุฏุฎุงู ุงูุชููููุงุช

else if (sec === 'tests') {
  main.innerHTML = `
    <div id="tests-section"><h2>๐งช ุฅุฏุฎุงู ุงูุงุฎุชุจุงุฑุงุช</h2>
    <div>
      <label>ุงูุณูุฉ:</label><span id="year">${new Date().getFullYear()}</span>
      <label>ุงูุดูุฑ:</label>
      <select id="eval-month">
        ${["ููุงูุฑ","ูุจุฑุงูุฑ","ูุงุฑุณ","ุฃุจุฑูู","ูุงูู","ููููู","ููููู","ุฃุบุณุทุณ","ุณุจุชูุจุฑ","ุฃูุชูุจุฑ","ููููุจุฑ","ุฏูุณูุจุฑ"]
          .map(m => `<option>${m}</option>`).join('')}
      </select>
      <label>ุงููุตู:</label><select id="eval-class" onchange="loadEvalStudents()"></select>
      <label>ุงูุทุงูุจ:</label><select id="eval-student" onchange="updateStudentName()"></select>
      <p>ุงุณู ุงูุทุงูุจ: <span id="stu-name"></span></p>
      <label>ุงุฎุชุจุงุฑ (10):</label><input type="number" id="input-test" min="0" max="10"/>
      <label>ูุงุฌุจ (10):</label><input type="number" id="input-home" min="0" max="10"/>
      <label>ูุดุงุฑูุฉ (10):</label><input type="number" id="input-part" min="0" max="10"/>
      <label>ุณููู (10):</label><input type="number" id="input-beh" value="10" min="0" max="10"/>
      <button class="save-btn" onclick="submitEvaluation()">ุญูุธ ุงูุชูููู</button>
    </div>

    <table id="eval-summary-table" style="width:100%; margin-top:20px; display:none;">
      <thead>
        <tr><th>ุงูุงุณู</th><th>ุงุฎุชุจุงุฑ</th><th>ูุงุฌุจ</th><th>ูุดุงุฑูุฉ</th><th>ุณููู</th><th>ุงููุฌููุน</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    </div>`;
  loadEvalClasses();
}

// ุชุญููู ูุตูู ุงููุนูู ููุงุฆูุฉ ุฅุฏุฎุงู ุงูุชูููู
async function loadEvalClasses() {
  const sel = document.getElementById('eval-class');
  sel.innerHTML = '';

  const snap = await db.collection('classes')
    .where('teacher', '==', currentTeacherId)
    .get();

  snap.forEach(doc => {
    const d = doc.data();
    const opt = document.createElement('option');
    opt.value = doc.id;
    opt.textContent = `${d.grade} - ${d.system} - ${d.section}`;
    sel.appendChild(opt);
  });

  if (snap.docs.length > 0) {
    loadEvalStudents();
  }
}

// ุชุญููู ุทูุงุจ ุงููุตู ุงููุฎุชุงุฑ
async function loadEvalStudents() {
  const classId = document.getElementById('eval-class').value;
  const sel = document.getElementById('eval-student');
  sel.innerHTML = '';

  const snap = await db.collection('students')
    .where('classId', '==', classId)
    .orderBy('seatNumber')
    .get();

  snap.forEach(doc => {
    const d = doc.data();
    const opt = document.createElement('option');
    opt.value = doc.id;
    opt.textContent = d.name;
    sel.appendChild(opt);
  });

  updateStudentName();
}

// ุนุฑุถ ุงุณู ุงูุทุงูุจ ุงููุญุฏุฏ
async function updateStudentName() {
  const studentId = document.getElementById('eval-student').value;
  const span = document.getElementById('stu-name');
  if (!studentId) return span.textContent = '';
  const doc = await db.collection('students').doc(studentId).get();
  if (doc.exists) span.textContent = doc.data().name;
}

// ุญูุธ ุงูุชูููู ููุทุงูุจ
async function submitEvaluation() {
  const classId = document.getElementById('eval-class').value;
  const studentId = document.getElementById('eval-student').value;
  const month = document.getElementById('eval-month').value;
  const year = new Date().getFullYear();

  const test = parseInt(document.getElementById('input-test').value) || 0;
  const home = parseInt(document.getElementById('input-home').value) || 0;
  const part = parseInt(document.getElementById('input-part').value) || 0;
  const beh = parseInt(document.getElementById('input-beh').value) || 0;
  const total = test + home + part + beh;

  if (!studentId || !classId || !month) return alert('โ๏ธ ุชุฃูุฏ ูู ุงุฎุชูุงุฑ ุงููุตู ูุงูุทุงูุจ ูุงูุดูุฑ');

  // ุงูุชุญูู ูู ุงูุชูุฑุงุฑ
  const check = await db.collection('evaluations')
    .where('classId', '==', classId)
    .where('studentId', '==', studentId)
    .where('month', '==', month)
    .get();

  if (!check.empty) {
    return alert('โ๏ธ ุชู ุชูููู ูุฐุง ุงูุทุงูุจ ููุฐุง ุงูุดูุฑ ูุณุจูุงู');
  }

  const studentDoc = await db.collection('students').doc(studentId).get();
  const name = studentDoc.exists ? studentDoc.data().name : 'ุทุงูุจ';

  await db.collection('evaluations').add({
    classId,
    studentId,
    teacher: currentTeacherId,
    name,
    test,
    home,
    part,
    beh,
    total,
    month,
    year
  });

  alert('โ๏ธ ุชู ุญูุธ ุงูุชูููู ุจูุฌุงุญ');
  showEvaluationSummary();
}

// ุนุฑุถ ููุฎุต ุงูุชูููู ูู ุงูุฌุฏูู ุฃุณูู ุงูุตูุญุฉ
async function showEvaluationSummary() {
  const classId = document.getElementById('eval-class').value;
  const month = document.getElementById('eval-month').value;

  const table = document.getElementById('eval-summary-table');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';

  const snap = await db.collection('evaluations')
    .where('classId', '==', classId)
    .where('month', '==', month)
    .get();

  if (snap.empty) {
    table.style.display = 'none';
    return;
  }

  snap.forEach(doc => {
    const d = doc.data();
    const row = `<tr>
      <td>${d.name}</td>
      <td>${d.test}</td>
      <td>${d.home}</td>
      <td>${d.part}</td>
      <td>${d.beh}</td>
      <td>${d.total}</td>
    </tr>`;
    tbody.innerHTML += row;
  });

  table.style.display = '';
}



  </script> 
</body>
</html>








